DISK_PARTED
=========

Данная роль создаёт одну физическую партицию, на которой создаёт логические разделы, файловую систему и точки монтирования.

Требования
------------

Для корректной работы роли требуется утилита parted (по умолчанию устанавливается при запуске плэйбука).
Также перед запуском плэйбука ОБЯЗАТЕЛЬНО требуется указать номер создаваемого физического раздела, переменная `disk_parted.device_num`.

Конфигурация
--------------

Переменные конфигураций находятся в директории `./defaults`.
Пример конфигурации:
```yaml
disk_parted:
  device_name: vdb      # название диска
  device_num: 1         # номер создаваемой партиции. Если не создано ни одной указываем 1
  device_type: primary  # Тип партиции
  device_label: msdos   # Используемая таблица разделов
vg_name: data    # Volume group name
```

В `lv_partitions` указываются создаваемые logical volumes.
Пример конфигурации:
```yaml
  cdr:                                  # Logical volume name. 
    part_size: 3g                       # Размер раздела
    part_fs: xfs                        # Тип файловой системы
    part_path: "{{ base_dir }}"         # Директория в которую будет монтироваться раздел
```

Для `swap` `part_path` указывать не нужно (Если очень хочется, то можно указать, но работать это не будет, поскольку `swap` монтируется строго в определённую директорию, указаную в `/tasks`)

Информация о значениях, которые могут принимать вышеперечисленные поля содержится в документации ansible, модуль parted

Структура
------------

Роль состоит из нескольких tasks:
create_partitions.yml - создаёт физические и логические разделы
lv_create.yml - содержит таски для создания логических разделов, является частью create_partitions.yml
create_fs.yml - создаёт файловую систему на разделах
mount_partitions.yml - монтирует разделы
mount_blocks.yml - содержит таски для монтирования разделов, является частью mount_partitions.yml
main.yml - выполняет вышеперечисленные tasks

Playbook
----------------

Плэйбук находится в корневой директории, называется disk_partition_new.yml


Author Information
------------------

Максим Демченко
